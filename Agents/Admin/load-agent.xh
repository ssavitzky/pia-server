<!DOCTYPE  html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>
<title>Load Agent</title>
</head><body bgcolor='#ffffff' link='#c40026' vlink='#e40026'>
<header>Load Agent</header>
<if>&FORM:quiet;<else><sub-head page='load-agent' /></else></if>
<hr />
<if><get name="FORM:load" />
    <then><!-- ============== Load a file and report =============== -->
	  <set name='a-path'><agent-load register>&FORM:file;</agent-load></set>
	  <if><get name='a-path'>
	      <then>
		 <h2>Agent &a-path; loaded</h2>
		 <user-message>Agent &a-path; loaded from &FORM:file;</user-message>
		 <if>&FORM:quiet;
		     <else><!-- Not quiet: report information -->
		       <table>
			 <tr><th align='right'>Root: </th>
			     <td><a href="&a-path;">&a-path;</a></td>
			 </tr>
			 <tr><th align='right'>Home: </th>
			     <td><a href="&a-path;~">&a-path;~</a></td>
			 </tr>
			 <tr><th align='right'>Index: </th>
			     <td><a href="&a-path;~/">&a-path;~/</a></td>
			 </tr>
			 <tr><th align='right'>Options: </th>
			     <td><a href="&a-path;~/options"
				    >&a-path;~/options</a></td>
			 </tr>
		       </table>
		     </else>
	        </if>
	     </then>
	     <else>
		<h3>Loading &FORM:file; failed</h3>
		<p> Either the file does not exist, or it does not contain an
		    AGENT element. </p>
	     </else>
	 </if>
    </then>
<else-if><get name="FORM:dst" />
    <then><!-- ============== Register a saved agent      =============== -->
	<h2>Agent &FORM:a-path; Registered.</h2>
	<register-agent id="&FORM:a-path;"
			on-start="&FORM:on-start;">&FORM:dst;</register-agent>
    </then>
    <else><!-- ============== No source file: ask for one =============== -->
	<h2>Load an agent from an XML file:</h2>
	<form action='/&AGENT:name;/load-agent' method='POST'>
	  <input type='submit' name="load" value="Load" />
	  <input type='submit' name="view" value="View" />
	  <set name="file"><get name="FORM:file" /></set>
	  &nbsp;<input name="file" value="&file;" size='40' />

	  <p> This form is used to ``load'' an Agent from an XML file that
	      specifies the internal data structure to be constructed.  If you
	      want to create an agent from its attributes, you should use
	      <code><a href="create-agent">create-agent</a></code>. </p>

	  <p> The ``<input name=quiet type=checkbox> <strong>quiet</strong>''
	      option is mainly used during initialization, to skip the
	      possibly-expensive step of extracting and reporting information
	      from the newly-loaded agent.</p>

	  <p> The ``View'' button can be used to preview an agent's XML data
	      before loading it. </p>
	</form>
    </else>
</if>

<if>&FORM:file;
    <then>
<hr />
<h2><code>&FORM:file;</code></h2>
<pre><protect markup result>
<include src="&FORM:file;" unprocessed />
</protect></pre>
    </then>
</if>

<hr />
<form>
<table border="0">
<tr><td valign="center">
<h2>Known agent-description files</h2> </td></tr>
<td bgcolor="silver">
<if>&AGENT:doNotSave;
    <else>
  <input type="submit" name="saveList" value="Save agent file list">
  <if>&FORM:saveList;
      <then><strong><code>agent-files.xml</code> written.</strong>
	    <output dst="agent-files.xml">
<!DOCTYPE agent-files SYSTEM "Admin-xhtml">
<!-- Written by load-agent.xh -->
&AGENT:agent-files;
</output>
      <user-message>agent-files.xml written.</user-message>
      </then>
  </if>
    </else>
</if>
</td>
<tr><td></td></tr>
</table>
</form>

<table border="1">
  <tr><th> Agent </th>
      <th> on start? </th>
      <th align="left"> XML file  </th>
      <td> (click to view) </td>
  </tr>
<repeat><foreach><extract><from>&AGENT:agent-files;</from>
			  <name recursive>agent-file</name></extract></foreach>
	<set name=id><extract><from>&li;</from><attr>id</attr><eval/>
		     </extract></set>
	<set name=on-start><extract><from>&li;</from>
		                    <attr>on-start</attr><eval/>
		           </extract></set>
        <set name="file"><extract><from>&li;</from><content /></extract></set>

  <tr><td><if>&id;<then><if><agent-running name="&id;" />
			    <then><a href="&id;~">&id;</a></then>
			    <else>&id;</else></if></then>
		  <else>&nbsp;</else></if>
      </td>
      <td><if>&on-start;<then>yes</then><else>&nbsp;</else></if></td>
<!-- file should be a link to this form with file pre-loaded -->
      <td colspan="2"><a href="load-agent?file=&file;">&file;</a></td>
  </tr>
</repeat>
</table>

<verbosePage>
<hr />
<h2>Agent files</h2>
<pre><protect markup result>
&AGENT:agent-files;
</protect></pre>
</verbosePage>

<short-footer cvsid='$Id: load-agent.xh,v 1.3 1999-07-09 22:06:14 steve Exp $'/>
</body></html>
